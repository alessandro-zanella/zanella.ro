<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Zanella Events</title>
  <meta name="description" content="Upcoming events at Zanella Lounge — join us for special evenings and experiences." />
  <!-- PWA / mobile chrome hints -->
  <meta name="theme-color" content="#171b1f">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <div class="ambient" aria-hidden="true"></div>
  <canvas id="particles" aria-hidden="true"></canvas>

  <!-- Logo header to go back to index -->
  <div class="logo-header" style="position:sticky; top:0; z-index:50; backdrop-filter:saturate(140%) blur(10px); background:rgba(23,27,31,.6); border-bottom:1px solid var(--line);">
    <div class="container nav-inner">
      <a href="index.html" class="brand" aria-label="Back to Home">
        <img src="assets/ZANELLA%20LOGO%20WHITE.png" alt="Zanella" style="padding:5px; padding-right:40px; height:28px; display:block; object-fit:contain;">
      </a>
    </div>
  </div>

  <!-- Upcoming Events List -->
  <section id="events-list" class="section" style="padding-top:60px;">
    <div class="container">
      <div class="reveal">
        <h2 style="margin-bottom:1rem;">Upcoming Events</h2>
        <p class="inline-note" style="margin-bottom:2rem;">Join us for special evenings and experiences.</p>
      </div>
      <div id="eventsListContainer" class="grid" style="grid-template-columns:repeat(auto-fill, minmax(320px, 1fr)); gap:20px;">
        <!-- Events will be populated from JSON -->
      </div>
    </div>
  </section>

  <!-- Event Details Modal -->
  <div id="eventModal" class="event-modal" style="display:none;">
    <div class="event-modal-overlay" onclick="closeEventModal()"></div>
    <div class="event-modal-panel">
      <button class="event-modal-close" onclick="closeEventModal()" aria-label="Close">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <div id="eventModalContent">
        <!-- Content will be populated from JSON -->
      </div>
    </div>
  </div>
  
  <style>
    /* Logo header responsive styles */
    @media(max-width:768px){
      .logo-header .brand img{ height:24px !important; padding-right:20px !important }
      .logo-header .nav-inner{ height:56px; padding:0 15px }
    }
    @media(max-width:480px){
      .logo-header .brand img{ height:20px !important; padding-right:15px !important }
      .logo-header .nav-inner{ height:52px; padding:0 12px }
    }
    
    @media(max-width:768px){
      #events-list{ padding-top:50px !important }
      #eventsListContainer{ grid-template-columns:1fr !important; gap:1.5rem !important }
    }
    @media(max-width:480px){
      #events-list{ padding-top:40px !important }
      #eventsListContainer{ gap:1.25rem !important }
      #events-list h2{ font-size:1.5rem }
      #events-list .card{ padding:1.5rem 1.25rem !important }
    }

    /* Event Modal Styles */
    .event-modal{
      position:fixed;
      inset:0;
      z-index:100;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      opacity:0;
      visibility:hidden;
      transition:opacity 0.3s var(--easing), visibility 0.3s var(--easing);
    }
    .event-modal.active{
      opacity:1;
      visibility:visible;
    }
    .event-modal-overlay{
      position:absolute;
      inset:0;
      background:rgba(0,0,0,0.75);
      backdrop-filter:blur(8px);
      cursor:pointer;
    }
    .event-modal-panel{
      position:relative;
      z-index:1;
      background:var(--panel-bg);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      max-width:800px;
      width:100%;
      max-height:90vh;
      overflow-y:auto;
      padding:32px;
      transform:scale(0.95) translateY(20px);
      transition:transform 0.3s var(--easing);
    }
    .event-modal.active .event-modal-panel{
      transform:scale(1) translateY(0);
    }
    .event-modal-close{
      position:absolute;
      top:20px;
      right:20px;
      background:rgba(255,255,255,0.1);
      border:1px solid var(--line);
      border-radius:10px;
      width:40px;
      height:40px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      color:var(--text);
      transition:background 0.2s var(--easing), transform 0.2s var(--easing);
      z-index:10;
    }
    .event-modal-close:hover{
      background:rgba(255,255,255,0.15);
      transform:rotate(90deg);
    }
    .event-modal-content h2{
      margin:0 0 0.5rem;
      font-size:2rem;
      color:var(--text);
    }
    .event-modal-content .event-date{
      color:var(--muted);
      font-size:0.95rem;
      margin-bottom:1rem;
    }
    .event-modal-content .event-location{
      display:flex;
      align-items:center;
      gap:0.5rem;
      color:var(--text);
      font-size:0.95rem;
      margin-bottom:1.5rem;
    }
    .event-modal-content .event-description{
      color:var(--muted);
      line-height:1.7;
      margin-bottom:1.5rem;
    }
    .event-modal-content .event-details{
      color:var(--text);
      line-height:1.7;
      margin-bottom:2rem;
    }
    .event-modal-content .event-highlights{
      margin-bottom:2rem;
    }
    .event-modal-content .event-highlights h3{
      margin:0 0 1rem;
      font-size:1.3rem;
      color:var(--text);
    }
    .event-modal-content .event-highlights ul{
      list-style:none;
      padding:0;
      margin:0;
      display:flex;
      flex-direction:column;
      gap:0.6rem;
    }
    .event-modal-content .event-highlights li{
      display:flex;
      align-items:flex-start;
      gap:0.75rem;
      color:var(--muted);
      line-height:1.6;
    }
    .event-modal-content .event-highlights li::before{
      content:"";
      width:6px;
      height:6px;
      border-radius:50%;
      background:var(--accent-3);
      margin-top:0.5rem;
      flex-shrink:0;
    }
    .event-modal-content .event-offers{
      margin-top:2rem;
      padding-top:2rem;
      border-top:1px solid var(--line);
    }
    body.modal-open{
      overflow:hidden;
    }

    @media(max-width:768px){
      .event-modal-panel{
        padding:24px;
        max-height:95vh;
      }
      .event-modal-close{
        top:16px;
        right:16px;
        width:36px;
        height:36px;
      }
      .event-modal-content h2{
        font-size:1.6rem;
        padding-right:50px;
      }
      .event-modal-content .event-offers .card{
        flex-direction:column !important;
        align-items:flex-start !important;
      }
      .event-modal-content .event-offers .card .btn{
        width:100%;
        justify-content:center;
      }
    }
    @media(max-width:480px){
      .event-modal{
        padding:12px;
      }
      .event-modal-panel{
        padding:20px;
      }
      .event-modal-content h2{
        font-size:1.4rem;
      }
      .event-modal-content .event-contact-info{
        margin-top:1.5rem !important;
        padding-top:1.5rem !important;
      }
      .event-modal-content .event-contact-info .btn{
        width:100%;
        justify-content:center;
      }
      .event-modal-content .event-offers .card{
        padding:14px !important;
      }
    }

    /* Footer responsive styles */
    @media(max-width:768px){
      footer .container > div{
        flex-direction:column !important;
        align-items:flex-start !important;
        gap:12px !important;
      }
      footer #footerSocial{
        align-items:flex-start !important;
      }
    }
    @media(max-width:480px){
      footer{
        padding:20px 0 !important;
      }
      footer .container{
        padding:20px 15px !important;
      }
    }
  </style>

  <footer style="border-top:1px solid var(--line); margin-top:48px;">
    <div class="container" style="display:flex; flex-direction:column; gap:16px; padding:24px 20px;">
      <div style="display:flex; justify-content:space-between; gap:20px; flex-wrap:wrap; align-items:center;">
        <div style="display:flex; flex-direction:column; gap:6px;">
          <span style="font-weight:600; color:var(--text); font-size:0.9rem;">&copy; <span id="year"></span> Zanella Lounge</span>
          <div id="footerContact" style="font-size:0.85rem; color:var(--muted); line-height:1.4;">
            <!-- Contact info will be populated from JSON -->
          </div>
        </div>
        <div id="footerSocial" style="display:flex; gap:12px; flex-wrap:wrap;">
          <!-- Social links will be populated from JSON -->
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Set --vh CSS variable for mobile browser viewport handling
    (function setVh(){
      function update(){
        try{ document.documentElement.style.setProperty('--vh', (window.innerHeight * 0.01) + 'px'); }catch(e){}
      }
      update();
      window.addEventListener('resize', update);
      window.addEventListener('orientationchange', update);
    })();

    // Particles
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (!prefersReduced) {
      const canvas = document.getElementById('particles');
      if (canvas) {
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const particles = [];
        const particleCount = Math.floor((canvas.width * canvas.height) / 15000);
        for (let i = 0; i < particleCount; i++) {
          particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 1.5 + 0.5,
            vx: (Math.random() - 0.5) * 0.5,
            vy: (Math.random() - 0.5) * 0.5
          });
        }
        function animate() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = 'rgba(255,255,255,0.1)';
          particles.forEach(p => {
            p.x += p.vx;
            p.y += p.vy;
            if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
            if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
            ctx.fill();
          });
          requestAnimationFrame(animate);
        }
        animate();
        window.addEventListener('resize', () => {
          canvas.width = window.innerWidth;
          canvas.height = window.innerHeight;
        });
      }
    }

    // Helper function to generate contact info HTML
    function getContactInfoHtml() {
      if (!window.contactData) return '';
      
      const contact = window.contactData;
      const contactItems = [];
      
      if (contact.contactInfo && contact.contactInfo.phone) {
        contactItems.push(`
          <a href="${contact.contactInfo.phone.href}" class="btn btn-green" aria-label="${contact.contactInfo.phone.ariaLabel}" style="display:inline-flex; align-items:center; gap:0.5rem;">
            ${contact.contactInfo.phone.icon}
            ${contact.contactInfo.phone.number}
          </a>
        `);
      }
      
      if (contact.contactInfo && contact.contactInfo.email) {
        contactItems.push(`
          <a href="${contact.contactInfo.email.href}" class="btn" aria-label="${contact.contactInfo.email.ariaLabel}" style="display:inline-flex; align-items:center; gap:0.5rem;">
            ${contact.contactInfo.email.icon}
            ${contact.contactInfo.email.address}
          </a>
        `);
      }
      
      const visitInfo = [];
      if (contact.visit && contact.visit.address) {
        visitInfo.push(`<p style="margin:0; color:var(--text);">${contact.visit.address}</p>`);
      }
      if (contact.visit && contact.visit.hours) {
        visitInfo.push(`<p class="inline-note" style="margin:0;">${contact.visit.hours}</p>`);
      }
      
      return `
        <div class="event-contact-info" style="margin-top:2rem; padding-top:2rem; border-top:1px solid var(--line);">
          <h3 style="margin:0 0 1rem; font-size:1.2rem; color:var(--text);">Contact Us</h3>
          <div style="display:flex; gap:0.6rem; flex-wrap:wrap; margin-bottom:1rem;">
            ${contactItems.join('')}
          </div>
          ${visitInfo.length > 0 ? `<div style="margin-top:1rem;">${visitInfo.join('')}</div>` : ''}
        </div>
      `;
    }

    // Event Modal Functions (defined early so they're available when event listeners are attached)
    window.openEventModal = function(event) {
      const modal = document.getElementById('eventModal');
      const modalContent = document.getElementById('eventModalContent');
      const eventsList = document.getElementById('events-list');
      
      if (!modal || !modalContent || !event) return;
      
      // Build highlights HTML
      const highlightsHtml = event.highlights && event.highlights.length > 0
        ? `
          <div class="event-highlights">
            <h3>What's Included</h3>
            <ul>
              ${event.highlights.map(highlight => `<li>${highlight}</li>`).join('')}
            </ul>
          </div>
        `
        : '';
      
      // Build offers HTML (up to 3 offers) - compact, each in own panel
      const offersHtml = event.offers && Array.isArray(event.offers) && event.offers.length > 0
        ? (() => {
            // Filter out invalid offers and take up to 3
            const validOffers = event.offers
              .filter(offer => offer && (offer.name || offer.title))
              .slice(0, 3);
            
            if (validOffers.length === 0) return '';
            
            return `
              <div class="event-offers">
                <h3 style="margin:0 0 1rem; font-size:1.2rem; color:var(--text);">Available Offers</h3>
                <div style="display:flex; flex-direction:column; gap:0.75rem;">
                  ${validOffers.map(offer => {
                    const name = offer.name || offer.title || '';
                    const description = offer.description || '';
                    const price = offer.price || '';
                    const paymentLink = offer.paymentLink || offer.href || '';
                    
                    return `
                      <div class="card" style="padding:16px; display:flex; justify-content:space-between; align-items:center; gap:16px; flex-wrap:wrap;">
                        <div style="flex:1; min-width:200px;">
                          ${name ? `<h4 style="margin:0 0 4px; font-size:1rem; font-weight:600; color:var(--text);">${name}</h4>` : ''}
                          ${description ? `<p style="margin:0 0 6px; font-size:0.9rem; color:var(--muted); line-height:1.4;">${description}</p>` : ''}
                          ${price ? `<p style="margin:0; font-size:1rem; font-weight:700; color:var(--accent-2);">${price}</p>` : ''}
                        </div>
                        ${paymentLink ? `
                          <div style="flex-shrink:0;">
                            <a href="${paymentLink}" class="btn btn-gold" target="_blank" rel="noopener" style="white-space:nowrap;">Buy Now</a>
                          </div>
                        ` : ''}
                      </div>
                    `;
                  }).join('')}
                </div>
              </div>
            `;
          })()
        : '';
      
      // Get contact info HTML
      const contactHtml = getContactInfoHtml();
      
      // Populate modal content
      modalContent.innerHTML = `
        <h2>${event.title}</h2>
        ${event.date ? `<p class="event-date">${event.date}</p>` : ''}
        <div class="event-location">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
          <span>${event.location}</span>
        </div>
        <p class="event-description">${event.description}</p>
        ${event.details ? `<div class="event-details">${event.details}</div>` : ''}
        ${highlightsHtml}
        ${offersHtml}
        ${contactHtml}
      `;
      
      // Show modal and hide events list
      modal.style.display = 'flex';
      setTimeout(() => {
        modal.classList.add('active');
      }, 10);
      document.body.classList.add('modal-open');
      if (eventsList) {
        eventsList.style.display = 'none';
      }
    };

    window.closeEventModal = function() {
      const modal = document.getElementById('eventModal');
      const eventsList = document.getElementById('events-list');
      
      if (!modal) return;
      
      modal.classList.remove('active');
      setTimeout(() => {
        modal.style.display = 'none';
        document.body.classList.remove('modal-open');
        if (eventsList) {
          eventsList.style.display = 'block';
        }
      }, 300);
    };

    // Content Loader — Load events list JSON
    async function loadEvents() {
      try {
        const eventsListData = await fetch('content/events/events-list.json').then(r => r.json());
        const footerData = await fetch('content/shared/footer.json').then(r => r.json());
        const contactData = await fetch('content/lounge/contact.json').then(r => r.json());
        
        // Store contact data globally for modal access
        window.contactData = contactData;

        // Helper function to parse date and check if event has passed
        function parseEventDate(dateString) {
          if (!dateString) return null;
          
          const today = new Date();
          today.setHours(0, 0, 0, 0);
          
          // Romanian month names mapping
          const romanianMonths = {
            'ianuarie': 0, 'februarie': 1, 'martie': 2, 'aprilie': 3,
            'mai': 4, 'iunie': 5, 'iulie': 6, 'august': 7,
            'septembrie': 8, 'octombrie': 9, 'noiembrie': 10, 'decembrie': 11
          };
          
          try {
            // Handle date ranges (e.g., "30 Ianuarie - 1 Februarie 2026")
            if (dateString.includes(' - ')) {
              const parts = dateString.split(' - ');
              const endDateStr = parts[parts.length - 1].trim();
              dateString = endDateStr; // Use the end date
            }
            
            // Try parsing Romanian date format (e.g., "1 Februarie 2026")
            const romanianMatch = dateString.match(/(\d+)\s+([a-z]+)\s+(\d+)/i);
            if (romanianMatch) {
              const day = parseInt(romanianMatch[1]);
              const monthName = romanianMatch[2].toLowerCase();
              const year = parseInt(romanianMatch[3]);
              
              if (romanianMonths[monthName] !== undefined) {
                const eventDate = new Date(year, romanianMonths[monthName], day);
                eventDate.setHours(23, 59, 59, 999); // End of day
                return eventDate >= today;
              }
            }
            
            // Try parsing standard English date format (e.g., "December 31, 2025")
            const englishMonths = {
              'january': 0, 'february': 1, 'march': 2, 'april': 3,
              'may': 4, 'june': 5, 'july': 6, 'august': 7,
              'september': 8, 'october': 9, 'november': 10, 'december': 11
            };
            
            const englishMatch = dateString.match(/([a-z]+)\s+(\d+),\s+(\d+)/i);
            if (englishMatch) {
              const monthName = englishMatch[1].toLowerCase();
              const day = parseInt(englishMatch[2]);
              const year = parseInt(englishMatch[3]);
              
              if (englishMonths[monthName] !== undefined) {
                const eventDate = new Date(year, englishMonths[monthName], day);
                eventDate.setHours(23, 59, 59, 999); // End of day
                return eventDate >= today;
              }
            }
            
            // Try standard Date parsing as fallback
            const parsedDate = new Date(dateString);
            if (!isNaN(parsedDate.getTime())) {
              parsedDate.setHours(23, 59, 59, 999);
              return parsedDate >= today;
            }
            
            // If we can't parse, show the event (better to show than hide)
            return true;
          } catch (e) {
            console.warn('Could not parse date:', dateString, e);
            // If parsing fails, show the event
            return true;
          }
        }

        // Store events data globally for modal access
        window.eventsData = eventsListData;

        // Populate Events List
        const eventsListContainer = document.getElementById('eventsListContainer');
        if (eventsListContainer && eventsListData && eventsListData.events) {
          // Filter out past events
          const upcomingEvents = eventsListData.events.filter(event => {
            if (!event.date) return true; // Show events without dates
            return parseEventDate(event.date);
          });
          
          if (upcomingEvents.length === 0) {
            eventsListContainer.innerHTML = '<div class="card reveal" style="padding:24px; text-align:center;"><p style="color:var(--muted);">No upcoming events at this time. Check back soon!</p></div>';
          } else {
            // Store filtered events for modal access
            window.upcomingEventsData = upcomingEvents;
            
            eventsListContainer.innerHTML = upcomingEvents.map((event, index) => {
              return `
                <div class="card reveal" style="padding:24px; display:flex; flex-direction:column;">
                  <h3 style="margin:0 0 .6rem; font-size:1.3rem; color:var(--text);">${event.title}</h3>
                  ${event.date ? `<p class="inline-note" style="margin:0 0 .8rem; font-size:.9rem;">${event.date}</p>` : ''}
                  <p style="margin:0 0 1rem; color:var(--muted); line-height:1.6; flex-grow:1;">${event.description}</p>
                  <p style="margin:0 0 1rem; color:var(--text); font-size:.95rem;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="display:inline-block; vertical-align:middle; margin-right:6px;">
                      <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                      <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    ${event.location}
                  </p>
                  <button class="btn btn-ghost event-more-info-btn" data-event-index="${index}" style="margin-top:auto;">More Info</button>
                </div>
              `;
            }).join('');
            
            // Attach event listeners to all "More Info" buttons
            eventsListContainer.querySelectorAll('.event-more-info-btn').forEach(btn => {
              btn.addEventListener('click', function() {
                const eventIndex = parseInt(this.getAttribute('data-event-index'));
                if (window.upcomingEventsData && window.upcomingEventsData[eventIndex] && window.openEventModal) {
                  window.openEventModal(window.upcomingEventsData[eventIndex]);
                } else {
                  console.error('Error opening modal:', {
                    hasData: !!window.upcomingEventsData,
                    hasEvent: !!(window.upcomingEventsData && window.upcomingEventsData[eventIndex]),
                    hasFunction: !!window.openEventModal,
                    eventIndex: eventIndex
                  });
                }
              });
            });
          }
          
          // Re-enable reveal animation for newly added elements
          if (typeof enableReveal === 'function') {
            enableReveal();
          }
        } else {
          console.error('Events container not found or events data missing', {
            container: eventsListContainer,
            data: eventsListData
          });
        }

        // Populate Footer
        const footerCopyright = document.querySelector('footer span:first-child');
        if (footerCopyright && footerData.copyright) {
          footerCopyright.innerHTML = `&copy; <span id="year"></span> ${footerData.copyright}`;
        }
        
        // Populate Footer Contact Info (compact, minimalist)
        const footerContact = document.getElementById('footerContact');
        if (footerContact && contactData) {
          const contactItems = [];
          if (contactData.contactInfo && contactData.contactInfo.phone) {
            contactItems.push(`<a href="${contactData.contactInfo.phone.href}" style="color:var(--muted); text-decoration:none; font-size:0.85rem;">${contactData.contactInfo.phone.number}</a>`);
          }
          if (contactData.contactInfo && contactData.contactInfo.email) {
            contactItems.push(`<a href="${contactData.contactInfo.email.href}" style="color:var(--muted); text-decoration:none; font-size:0.85rem;">${contactData.contactInfo.email.address}</a>`);
          }
          if (contactData.visit && contactData.visit.address) {
            contactItems.push(`<span style="font-size:0.85rem;">${contactData.visit.address}</span>`);
          }
          if (contactData.visit && contactData.visit.hours) {
            contactItems.push(`<span style="font-size:0.85rem;">${contactData.visit.hours}</span>`);
          }
          footerContact.innerHTML = contactItems.join(' · ');
        }
        
        // Populate Footer Social Links (compact)
        const footerSocial = document.getElementById('footerSocial');
        if (footerSocial && footerData.social) {
          footerSocial.innerHTML = footerData.social.map(s => `<a href="${s.url}" style="color:var(--muted); text-decoration:none; font-size:0.85rem; transition:color 0.2s;" onmouseover="this.style.color='var(--text)'" onmouseout="this.style.color='var(--muted)'">${s.text}</a>`).join(' · ');
        }
      } catch (error) {
        console.error('Error loading events:', error);
      }
    }

    // Reveal animation on scroll
    function enableReveal() {
      const reveals = document.querySelectorAll('.reveal');
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }
        });
      }, { threshold: 0.1 });
      reveals.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        el.style.transition = 'opacity 0.6s cubic-bezier(.16,1,.3,1), transform 0.6s cubic-bezier(.16,1,.3,1)';
        observer.observe(el);
      });
    }

    // Close modal on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        const modal = document.getElementById('eventModal');
        if (modal && modal.classList.contains('active')) {
          closeEventModal();
        }
      }
    });

    // Init
    window.addEventListener('DOMContentLoaded', async () => {
      await loadEvents();
      // Wait a bit for DOM to update, then enable reveal
      setTimeout(() => {
        enableReveal();
      }, 100);
      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();
    });
  </script>
</body>
</html>

